
# توثيق مشروع "صنايعيتي" - Sana'eyeti (MVP)

تطبيق سمسرة خدمات منزلية للسوق المصري يركز على الأمان، البساطة، والدفع الرقمي.

## 1️⃣ القيمة المضافة والمشكلة
**المشكلة:** صعوبة الحصول على فني موثوق، غياب السعر العادل، والتحايل في الدفع الكاش خارج منصات الوساطة.
**الحل:** نظام Escrow (حجز المبلغ) يضمن حق العميل في الجودة وحق الفني في الأتعاب، مع توثيق هوية كامل للفنيين.

## 2️⃣ تجربة المستخدم (User Flow)
1. **التسجيل:** رقم الموبايل + OTP.
2. **الاكتشاف:** خريطة تعرض الفنيين القريبين مع تقييماتهم.
3. **المرحلة الانتقالية (Review/Meet):** يتم التواصل عبر الشات داخل التطبيق لترتيب "معاينة".
4. **الاتفاق:** يرسل الفني عرض سعر، يوافق العميل ويدفع المبلغ (يُحجز في المحفظة).
5. **التنفيذ:** يبدأ العمل.
6. **الإنهاء:** يضغط العميل "تأكيد الانتهاء"، يتم تحويل المال للفني (ناقص 15% عمولة).

## 3️⃣ نموذج قاعدة البيانات (Database Schema)

### Users
- `id` (string, PK)
- `phone` (string, unique)
- `name` (string)
- `role` (enum: CUSTOMER, PROVIDER, ADMIN)
- `avatar_url` (string)

### Providers
- `user_id` (string, FK)
- `bio` (text)
- `services` (json array)
- `id_card_url` (string)
- `verified_status` (boolean)
- `rating` (float)
- `location` (point)

### Orders (Jobs)
- `id` (string, PK)
- `customer_id` (FK)
- `provider_id` (FK)
- `status` (PENDING, INTERVIEWING, DEPOSIT_PAID, IN_PROGRESS, COMPLETED, DISPUTED)
- `total_price` (decimal)
- `escrow_balance` (decimal)
- `commission_rate` (default 0.15)

### Transactions (Wallet)
- `id` (string, PK)
- `user_id` (FK)
- `amount` (decimal)
- `type` (CREDIT, DEBIT)
- `description` (string)

## 4️⃣ نظام مكافحة التحايل (Anti-Fraud)
1. **فلترة الشات:** نظام آلي يمنع مشاركة أرقام الهواتف أو روابط خارجية قبل حجز "المعاينة".
2. **كود التأكيد:** عند انتهاء العمل، يجب على الفني تصوير QR كود من موبايل العميل أو إدخال كود يرسل للعميل.
3. **عقوبات:** أي معاملة يتم رصد محاولة إتمامها كاش خارج التطبيق تؤدي لحظر دائم للفني.
4. **تأمين المحفظة:** لا يمكن سحب الأرباح إلا بعد مرور 48 ساعة من اكتمال الطلب (لفترة مراجعة النزاعات).

## 5️⃣ خطة الإطلاق (Go-To-Market)
- **المرحلة 1:** إطلاق تجريبي في "الشيخ زايد" و "التجمع" فقط.
- **الخدمات:** "سباكة" و "كهرباء" فقط للتحكم في الجودة.
- **التسويق:** إعلانات فيسبوك محلية (Targeted by Location) ومجموعات واتساب للسكان.

## 6️⃣ الواجهات البرمجية (API Endpoints)
- `POST /auth/otp`: إرسال كود التحقق.
- `GET /providers/nearby`: جلب الفنيين حسب الموقع.
- `POST /orders/create`: إنشاء طلب جديد (بدء مرحلة المقابلة).
- `POST /payments/escrow`: شحن المحفظة وحجز المبلغ للطلب.
- `PATCH /orders/:id/complete`: تأكيد انتهاء العمل وتحرير الأموال.
